# üîç **–ê–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ Discovery –∏ Advertising**

**–§–∞–π–ª:** `docs/functions/aggressive-discovery.md`  
**–í–µ—Ä—Å–∏—è:** v1.5  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 28 –∞–≤–≥—É—Å—Ç–∞ 2025

## üéØ **–û–±–∑–æ—Ä**

–ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ discovery –∏ advertising –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –ø–∏—Ä–æ–≤ –∏ –∞–Ω–æ–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ–±—è –≤ —Å–µ—Ç–∏. –≠—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑—É—é—Ç –ª–æ–≥–∏–∫—É –∏–∑ `poc.go` –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π.

## üìã **–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**

### **1. StartAggressiveDiscovery**
```c
int StartAggressiveDiscovery(char* rendezvous);
```

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–ø—É—Å–∫–∞–µ—Ç –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫ –ø–∏—Ä–æ–≤ –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É rendezvous.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `rendezvous` - —Å—Ç—Ä–æ–∫–∞ rendezvous –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–∏—Ä–æ–≤

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
- `0` - —É—Å–ø–µ—Ö
- `-1` - –æ—à–∏–±–∫–∞

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```c
int result = StartAggressiveDiscovery("my-super-secret-rendezvous-point");
if (result == 0) {
    printf("‚úÖ –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫ –∑–∞–ø—É—â–µ–Ω\n");
} else {
    printf("‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ –ø–æ–∏—Å–∫–∞\n");
}
```

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
- –ü–æ–∏—Å–∫ –ø–∏—Ä–æ–≤ –∫–∞–∂–¥—ã–µ 15 —Å–µ–∫—É–Ω–¥
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –Ω–∞–π–¥–µ–Ω–Ω—ã–º –ø–∏—Ä–∞–º
- –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–∏–º–æ–≤ –¥–ª—è –æ–±–º–µ–Ω–∞ –¥–∞–Ω–Ω—ã–º–∏
- Fallback —á–µ—Ä–µ–∑ relay –µ—Å–ª–∏ –ø—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ —É–¥–∞–µ—Ç—Å—è

---

### **2. StartAggressiveAdvertising**
```c
int StartAggressiveAdvertising(char* rendezvous);
```

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–ø—É—Å–∫–∞–µ—Ç –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ –∞–Ω–æ–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ–±—è –≤ —Å–µ—Ç–∏ –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É rendezvous.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `rendezvous` - —Å—Ç—Ä–æ–∫–∞ rendezvous –¥–ª—è –∞–Ω–æ–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
- `0` - —É—Å–ø–µ—Ö
- `-1` - –æ—à–∏–±–∫–∞

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```c
int result = StartAggressiveAdvertising("my-super-secret-rendezvous-point");
if (result == 0) {
    printf("‚úÖ –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ –∞–Ω–æ–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ\n");
} else {
    printf("‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ –∞–Ω–æ–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è\n");
}
```

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
- –ê–Ω–æ–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ–±—è –∫–∞–∂–¥—ã–µ 15 —Å–µ–∫—É–Ω–¥
- –ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –≤ DHT
- –û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ relay –∞–¥—Ä–µ—Å–æ–≤

---

### **3. FindPeersOnce**
```c
char* FindPeersOnce(char* rendezvous);
```

**–û–ø–∏—Å–∞–Ω–∏–µ:** –í—ã–ø–æ–ª–Ω—è–µ—Ç –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω—ã–π –ø–æ–∏—Å–∫ –ø–∏—Ä–æ–≤ –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É rendezvous.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `rendezvous` - —Å—Ç—Ä–æ–∫–∞ rendezvous –¥–ª—è –ø–æ–∏—Å–∫–∞

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
- JSON —Å—Ç—Ä–æ–∫–∞ —Å –Ω–∞–π–¥–µ–Ω–Ω—ã–º–∏ –ø–∏—Ä–∞–º–∏
- `NULL` - –æ—à–∏–±–∫–∞ –∏–ª–∏ –ø–∏—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã

**–§–æ—Ä–º–∞—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö:**
```json
[
  {
    "id": "12D3KooW...",
    "addrs": [
      "/ip4/192.168.1.100/tcp/1234",
      "/ip4/10.0.0.1/tcp/5678"
    ]
  }
]
```

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```c
char* result = FindPeersOnce("my-super-secret-rendezvous-point");
if (result != NULL) {
    printf("–ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø–∏—Ä—ã: %s\n", result);
    FreeString(result); // –ù–µ –∑–∞–±—ã–≤–∞–µ–º –æ—Å–≤–æ–±–æ–¥–∏—Ç—å –ø–∞–º—è—Ç—å!
} else {
    printf("–ü–∏—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã\n");
}
```

---

### **4. AdvertiseOnce**
```c
int AdvertiseOnce(char* rendezvous);
```

**–û–ø–∏—Å–∞–Ω–∏–µ:** –í—ã–ø–æ–ª–Ω—è–µ—Ç –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ–µ –∞–Ω–æ–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ–±—è –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É rendezvous.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `rendezvous` - —Å—Ç—Ä–æ–∫–∞ rendezvous –¥–ª—è –∞–Ω–æ–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
- `0` - —É—Å–ø–µ—Ö
- `-1` - –æ—à–∏–±–∫–∞

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```c
int result = AdvertiseOnce("my-super-secret-rendezvous-point");
if (result == 0) {
    printf("‚úÖ –ê–Ω–æ–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ\n");
} else {
    printf("‚ùå –û—à–∏–±–∫–∞ –∞–Ω–æ–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è\n");
}
```

## üîÑ **–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π**

### **StartAggressiveDiscovery:**
1. **–ü–æ–∏—Å–∫ –ø–∏—Ä–æ–≤** –∫–∞–∂–¥—ã–µ 15 —Å–µ–∫—É–Ω–¥
2. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è** - –∏—Å–∫–ª—é—á–µ–Ω–∏–µ —Å–∞–º–æ–≥–æ —Å–µ–±—è
3. **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ** –∫ –Ω–∞–π–¥–µ–Ω–Ω—ã–º –ø–∏—Ä–∞–º
4. **–°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–∏–º–æ–≤** –¥–ª—è –æ–±–º–µ–Ω–∞ –¥–∞–Ω–Ω—ã–º–∏
5. **Fallback** —á–µ—Ä–µ–∑ relay –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

### **StartAggressiveAdvertising:**
1. **–ê–Ω–æ–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ** —Å–µ–±—è –∫–∞–∂–¥—ã–µ 15 —Å–µ–∫—É–Ω–¥
2. **–ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ** –≤–∏–¥–∏–º–æ—Å—Ç–∏ –≤ DHT
3. **–°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è** relay –∞–¥—Ä–µ—Å–æ–≤
4. **–û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ** –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö –ø–∏—Ä–æ–≤

## ‚ö° **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞**

- **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:** –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:** Fallback –º–µ—Ö–∞–Ω–∏–∑–º—ã –ø—Ä–∏ —Å–±–æ—è—Ö
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –ë—ã—Å—Ç—Ä–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–∏—Ä–æ–≤
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –≤ poc.go

## üö® **–í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è**

### **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é:**
- **–í–°–ï–ì–î–ê –≤—ã–∑—ã–≤–∞—Ç—å `FreeString()`** –ø–æ—Å–ª–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫ –æ—Ç `FindPeersOnce()`
- –°—Ç—Ä–æ–∫–∏ –æ—Ç –¥—Ä—É–≥–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –Ω–µ —Ç—Ä–µ–±—É—é—Ç –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è

### **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ —Ñ–æ–Ω–µ
- –ù–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

### **–°–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫:**
- –ü–æ–∏—Å–∫ –∫–∞–∂–¥—ã–µ 15 —Å–µ–∫—É–Ω–¥
- –ê–Ω–æ–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥—ã–µ 15 —Å–µ–∫—É–Ω–¥
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ —Ç—Ä–∞—Ñ–∏–∫–∞

## üîß **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏**

### **–°–æ–±—ã—Ç–∏—è:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `GetNextEvent()` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è—Ö
- –°–æ–±—ã—Ç–∏—è `PeerConnected` –∏ `PeerDisconnected` –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏—è:**
- –§—É–Ω–∫—Ü–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `Connect()` –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ø–∏—Ä–∞–º
- Relay –∏ hole punching –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### **DHT:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `routing.RoutingDiscovery` –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏ –∞–Ω–æ–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π DHT –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π

## üìä **–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**

### **–†–µ–∂–∏–º "–°–ª—É—à–∞—Ç–µ–ª—è":**
```c
// –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–æ–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ
StartAggressiveAdvertising("my-rendezvous");

// –ñ–¥–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
while (1) {
    char* event = GetNextEvent();
    if (event != NULL) {
        printf("–°–æ–±—ã—Ç–∏–µ: %s\n", event);
        FreeString(event);
    }
    sleep(1);
}
```

### **–†–µ–∂–∏–º "–ò—Å–∫–∞—Ç–µ–ª—è":**
```c
// –ó–∞–ø—É—Å–∫–∞–µ–º –ø–æ–∏—Å–∫
StartAggressiveDiscovery("my-rendezvous");

// –ñ–¥–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
while (1) {
    char* event = GetNextEvent();
    if (event != NULL) {
        printf("–°–æ–±—ã—Ç–∏–µ: %s\n", event);
        FreeString(event);
    }
    sleep(1);
}
```

### **–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º:**
```c
// –ê–Ω–æ–Ω—Å–∏—Ä—É–µ–º—Å—è –∏ –∏—â–µ–º –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
StartAggressiveAdvertising("my-rendezvous");
StartAggressiveDiscovery("my-rendezvous");

// –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Å–æ–±—ã—Ç–∏—è
while (1) {
    char* event = GetNextEvent();
    if (event != NULL) {
        printf("–°–æ–±—ã—Ç–∏–µ: %s\n", event);
        FreeString(event);
    }
    sleep(1);
}
```

## üéØ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
2. **–ö–æ–º–±–∏–Ω–∏—Ä—É–π—Ç–µ –∞–Ω–æ–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–æ–∏—Å–∫** –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –≤–∏–¥–∏–º–æ—Å—Ç–∏
3. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ —Å–æ–±—ã—Ç–∏—è** —á–µ—Ä–µ–∑ `GetNextEvent()`
4. **–ù–µ –∑–∞–±—ã–≤–∞–π—Ç–µ –æ—Å–≤–æ–±–æ–∂–¥–∞—Ç—å –ø–∞–º—è—Ç—å** –ø–æ—Å–ª–µ `FindPeersOnce()`

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 28 –∞–≤–≥—É—Å—Ç–∞ 2025  
**–ê–≤—Ç–æ—Ä:** Core Development Team
